<!doctype html>
<html lang="en">

  <head>
    <meta charset="utf-8">

    <title>RESTful Web APIs</title>

    <meta name="description" content="A framework for easily creating beautiful presentations using HTML">
    <meta name="author" content="Hakim El Hattab">

    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/theme/white.css" id="theme">

    <!-- Code syntax highlighting -->
    <link rel="stylesheet" href="lib/css/zenburn.css">

    <!-- Printing and PDF exports -->
    <script>
      var link = document.createElement( 'link' );
      link.rel = 'stylesheet';
      link.type = 'text/css';
      link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
      document.getElementsByTagName( 'head' )[0].appendChild( link );
    </script>

    <!--[if lt IE 9]>
    <script src="lib/js/html5shiv.js"></script>
    <![endif]-->
  </head>

  <body>

    <div class="reveal">

      <!-- Any section element inside of this container is displayed as a slide -->
      <div class="slides">
        <section>
        <h1>RESTful Web APIs</h1>
        <h3>& the hypermedia constraint</h3>
        <p>
        <small>By <a href="https://twitter.com/feminstwerewolf">Alex Moore-Niemi</a></small>
        </p>
        </section>

        <section>
        <section>
        <h2>What's the intent of this presentation?</h2>
        <p>
        To get you to build RESTful web APIs, and to use the hypermedia constraint as a tool for doing that.
        </p>
        </section>
        <section>
        <p>How do you get someone to use something?</p>
        <ol>
          <li>inspire them to <i>want</i> to use it</li>
          <li>show them <i>how</i> to use it</li>
        </ol>
        </section>
        </section>

        <section>
        <section>
        <h2>Why build RESTful Web APIs?</h2>
        <p class="fragment">Constraints restrict complexity.</p>
        <p class="fragment">Flexibility for growth.</p>
        <p class="fragment">Ubiquitous support.</p>
        </section>
        <section>
        <h2>Is REST new?</h2>
        <p><i>("Just seems like hype to me!")</i></p>
        <h2 class="fragment">No.</h2>
        <p class="fragment">REST (<a href="https://www.ics.uci.edu/~fielding/pubs/dissertation/top.htm">Representational State Transfer</a>) is merely an academic codification of the architectural constraints that describe the Web.</p>
        </section>
        </section>

        <section>
        <h2>What <i>is</i> the Web?</h2>
        <p>
        HTTP, URLs, and HTML.
        </p>
        <p class="fragment"><i>Pssst.</i> What about Javascript?</p>
        <p class="fragment">It satisfies one of the <i>optional</i> constraints in REST: "Mobile Code On Demand".</p>
        </section>

        <section data-background="raptor_blur.jpg">
        <p style="color:white;">But like, what <i>IS</i> the web???</p>
        <p style="color:white;" class="fragment">The web is a distributed computing system.</p>
        <p style="color:white;" class="fragment">What do all useful computational systems need to do?</p>
        <p style="color:white;" class="fragment">Manipulate <i>state</i>.</p>
        </section>

        <section id="state-kinds">
        <p>State on the Web is of two types:</p>
        <ol>
          <li>Resource state</li>
          <li>Application state</li>
        </ol>
        <p>How do we make state changes?</p>
        <p class="fragment">Representations!</p>
        <p class="fragment">(That's why it's called Representational State Transfer. :))</p>
        <p class="fragment"><a href="#/transition-kinds">How do we represent state transitions on the web?</a></p>
        </section>

        </section>

        <section>
        <section>
        <p>Working RESTfully means leveraging the Web as a core technology and organizing principle.</p>
        <p>
        How do we generally approach writing programs?
        </p>
        <p class="fragment">We model what we think needs to happen.</p>
        <p class="fragment">We check for libraries that support our use case.</p>
        <p class="fragment">We re-model our first pass given existing libraries.</p>
        <p class="fragment">We write our program in the context of a dependency graph.</p>
        </section>
        <section>
        <p>If we approach the "Web" as libraries we can use, what do we get out of the box?</p>
        <h2 class="fragment">Protocol semantics.</h2>
        <h2 class="fragment">Domain semantics.</h2>
        <h2 class="fragment">Application semantics.</h2>
        </section>
        </section>

        <section>
        <section>
        <p>What are protocol semantics anyway?</p>
        <blockquote class="fragment">"the set of rules regarding how to fashion valid requests and responses using one or more message protocols"</blockquote>
        </section>
        <section>
        <p>Yeah, yeah yeah... I've seen POST, PUT, DELETE, etc...</p>
        <p class="fragment">HTTP alone has a lot more semantics than you might think.</p>
        </section>
        <section>
        <ul>
          <li>RFC 7230, HTTP/1.1: Message Syntax and Routing</li>
          <li>RFC 7231, HTTP/1.1: Semantics and Content</li>
          <li>RFC 7232, HTTP/1.1: Conditional Requests</li>
          <li>RFC 7233, HTTP/1.1: Range Requests</li>
          <li>RFC 7234, HTTP/1.1: Caching</li>
          <li>RFC 7235, HTTP/1.1: Authentication</li>
        </ul>
        <p>HTTP/2 was published as RFC 7540 in May 2015.</p>
        </section>

        <section>
        <p>Meh. Why not just overload POST with everything you need?</p>
        <p class="fragment" align="left">When you use POST with overloaded semantics, you're limiting yourself to thinking in function calls.</p>
        <p class="fragment" align="left">Your alternative is <a href="http://www.sapphiresteel.com/Tutorials/sapphire-ruby-in-steel-tutorials/Programming/Ruby-The-Smalltalk-Way-1.html">message passing</a>. Does the Web offer that?</p>
        <h2 class="fragment" align="left">Yes.</h2>
        <p class="fragment" align="left">One of the Fielding constraints of REST is "self-describing messages".</p>
        </section>

        <section>
        <p align="left">What can message passing give us that function calling can't?</p>
        <p class="fragment" align="left">When a <i>function</i> fails, typically, it only knows how to return an error. Alternatively, a <i>message</i> is passed to an <i>object</i>, which is free to reply, "well, I didn't understand this message, but how about..?"</p>
        <p class="fragment" align="left">On the web, the server can categorize messages more <i>meaningfully</i>, when we use protocol semantics, which helps us create more meaingful responses to the client.</p>
        </section>

        <section>
        <blockquote>The key in making great and growable systems is much more to design how its modules communicate rather than what their internal properties and behaviors should be. Think of the internet - to live, it (a) has to allow many different kinds of ideas and realizations that are beyond any single standard and (b) to allow varying degrees of safe interoperability between these ideas. </blockquote>
        </section>

        <section>
        <blockquote>If you focus on just messaging - and realize that a good metasystem can late bind the various 2nd level architectures used in objects - then much of the language-, UI-, and OS based discussions on this thread are really quite moot.</blockquote>
        <p>Alan Kay (inventor of Smalltalk), <a href="http://c2.com/cgi/wiki?AlanKayOnMessaging">on messaging</a></p>
        </section>

        <section>
        <p align="left">For instance, if you want to create something and format your POST request wrong,</p>
        <p class="fragment" align="left">The server could inspect your malformed message and reply with a response explaining <i>how</i> to actually create the new resource you were addressing.</p>
        <p class="fragment" align="left"> If you're POST'ing essentially to just an undefined function (RPC-style) the server can't do any better than say "this doesn't exist in my namespace. :c"</p>
        </section>
        <section>
        <p>Our standard error response:</p>
        <pre><code>{
  key: "system_error"
  message: "An unexpected error has occurred. Please contact support if the problem persists."
}
</pre></code>
        <p>Collection+JSON write template:</p>
        <pre><code>"template" : {
      "data" : [
        {"name" : "full-name", "prompt" : "Full Name"},
        {"name" : "email", "prompt" : "Email"},
        {"name" : "blog", "prompt" : "Blog"},
        {"name" : "avatar", "prompt" : "Avatar"}

      ]
    }
</pre></code>
        </section>
        </section>

        <section>
        <section>
        <p align="left">Protocol semantics help define the control flow of our application, but they would be a pretty weak application on their own.</p>
        <table>
          <tr><td>POST</td><td>Create</td></tr>
          <tr><td>GET</td><td>Read</td></tr>
          <tr><td>PUT</td><td>Update</td></tr>
          <tr><td>PATCH</td><td></td></tr>
          <tr><td>DELETE</td><td>Delete</td></tr>
        </table>
        <p align="left" class="fragment">If we need more than CRUD, we need our own application semantics. So protocol semantics at bottom, application semantics at top...</p>
        </section>
        <section>
        <p class="fragment" align="right">How do we fill the gap?</p>
        <p class="fragment" id="fill_the_gap" data-state="fill_the_gap"></p>
        <p><canvas id="semantics_pyramid" width="600" height="600"></canvas></p>
        </section>
        </section>

        <section>
        <h2>HTML</h2>
        <p align="left">Hyper Text Markup Language is the original hypermedia type.</p>
        <div id="factors" style="width:20%;padding:10px;float:right;clear:both;">
          <table class="hfactors">
            <thead>
              <tr>
                <th colspan="5"><a href="http://amundsen.com/hypermedia/hfactor/" title="Hypermedia Factors" class="hfactor-link">Hypermedia Factors</a></th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td></td>
                <td></td>
                <td class="border cd"><a href="/hypermedia/hfactor/#cl" title="Control Data for Links">CL</a></td>
                <td></td>
                <td></td>
              </tr>
              <tr>
                <td></td>
                <td class="border">CR</td>
                <td class="border cd"><a href="/hypermedia/hfactor/#cu" title="Control Data for Updates">CU</a></td>
                <td class="border cd"><a href="/hypermedia/hfactor/#cm" title="Control Data for Interface Methods">CM</a></td>
                <td></td>
              </tr>
              <tr>
                <td class="border ld"><a href="/hypermedia/hfactor/#le" title="Embedded Links">LE</a></td>
                <td class="border ld"><a href="/hypermedia/hfactor/#lo" title="Outbound Links">LO</a></td>
                <td class="border ld"><a href="/hypermedia/hfactor/#lt" title="Templated Links">LT</a></td>
                <td class="border ld"><a href="/hypermedia/hfactor/#ln" title="Non-Idempotent Update Links">LN</a></td>
                <td class="border">LI</td>
              </tr>
            </tbody>
          </table>
        </div>
        <p align="left">Its <b>protocol semantics</b> are limited: <font color="red">PUT and DELETE in HTTP are not supported</font>.</p>
        <p align="left">Its <b>domain semantics</b> are specifically about sharing <a href="http://www.w3.org/TR/html5/">a network of human readable documents</a>, which is a very popular and very flexible domain.</p>
        <p align="left">If your application matches that domain 1:1, you're all set: HTML has you covered. (Consider <a href="https://www.wikipedia.org/">Wikipedia</a>.)</p>
        </section>

        <section data-background="http://www.icxm.net/team/uploads/Misc/1.png">
            <pre><code><a href="" rel="">This is where we will start our API.</a></code></pre>
        </section>

        <section>
        <section>
        <h2>Hypermedia</h2>
        <blockquote>
          "a way for the server to tell the client what HTTP requests the client might want to make in the future"
        </blockquote>
        </section>

        <section id="transition-kinds">
        <p align="left"><a href="http://amundsen.com/hypermedia/hfactor/">H-Factors</a> are the categories of <b>state transitions</b> that hypermedia can help the client and server format as messages.</p>
        <pre><code data-trim contenteditable>
<img src="http://www.example.org/images/logo" title="company logo" />

<a href="http://www.example.org/search" title="view search page">Search</a>

<form method="get">
  <label>Search term:</label>
  <input name="query" type="text" value="" />
  <input type="submit" />
</form>

<form method="post" action="http://www.example.org/my-keywords"/>
  <label>Keywords:</label>
  <input name="keywords" type="text" value="" />
  <input type="submit" />
</form>
</code></pre>
        <a href="#/state-kinds">What kinds of state do we have on the web?</a>
        </section>
        </section>

        <section>
        <section>
        <p>So how do we design a RESTful API?</p>
        </section>
        <section>
        <ol><li><p><span>Semantic descriptors: list all info a client might have as input/output</span></p></li>
          <li><p><span>Link relations: Draw a state diagram</span></p><p><span><small>What do we understand at this point in the process? Protocol semantics.</small></span></p></li>
          <li><p><span>Check against existing profiles: can you leverage any?</span></p></li>
          <li><p><span>Choose a media type</span></p></li>
          <li><p><span>Write your profile of your application semantics</span></p><p><span><small>The more you found in 3 and 4, the less you need to do in 5.</small></span></p></li>
          <li style="color:grey;"><p><span style="color:grey;">Code!!</span></p></li>
          <li style="color:grey;"><p><span style="color:grey;">Publish the "billboard URL"</span></p></li>
        </ol>
        </section>

        <section>
        <p align="left">ZipErrands API</p>
        <p align="left">Use case: As a Zipcar member, I want to find the nearest car available, so that I can use it to run an errand that will take under an hour.</p>
        </section>

        <section>
        <p align="left">Input: current location of user.</p>
        <p align="left">Output: cars (must have distance to, features, picture of), car keys (allows device to unlock car), reservation invoice (billed amount).</p>
        <p align="left">Semantic descriptors: current_location, distance_to, features, picture_of, car_keys, reservation_invoice</p>
        </section>

        <section>
        <p align="left">Link relations: search, cars, car, prev/next, back, claim</p>
        <img src="/ZipcarErrandAPI.png">
        </section>

        <section>
        <p align="left">Reconcile names:</p>
        <ul>
          <li>current_location, distance_to: <a href="https://schema.org/GeoCoordinates">GeoCoordinates</a></li>
          <li>reservation_invoice: <a href="https://schema.org/Invoice">Invoice</a></li>
          <li>claim: <a href="https://schema.org/RentalCarReservation">RentalCarReservation</a></li>
          <li>car: <a href="http://sdo-property-value-and-cars.appspot.com/Car">Car</a></li>
          <li>cars: <a href="https://schema.org/SearchResultsPage">SearchResultsPage</a></li>
        </ul>
        <p class="fragment" align="right"><i>Why</i> reconcile names?</p>
        <p class="fragment" align="left">Search engines like Google have a vested interest in being able to parse content on the web semantically. Ever received <a href="https://developers.google.com/gmail/markup/">an email that highlighted your upcoming flight</a>?</p>
        </section>

        <section>
        <p>That's the power of using <a href="http://schema.org/">Schema.org</a> markup.</p>
        <img src="carousel-inbox.png">
        </section>

        <section>
        <p>What do we need out of a media type?</p>
        <p class="fragment" align="left">The media type most devs are familiar with is <a href="http://json.org/">JSON</a>, but it is <b>not</b> a hypermedia format.</p>
        <p class="fragment" align="left">What could a hypermedia format give us out of the box that a vanilla data structure like JSON can't?</p>
        </section>
        </section>

        <section>
        <p>What tools out there can we use to help us?</p>
        </section>

      </div>

    </div>

    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.js"></script>

    <script>
      // Full list of configuration options available at:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({

        slideNumber: true,
        controls: true,
        progress: true,
        history: true,
        center: true,

        transition: 'slide', // none/fade/slide/convex/concave/zoom

        // Optional reveal.js plugins
        dependencies: [
        { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
        { src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
        { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
        { src: 'plugin/highlight/highlight.js', async: true, condition: function() { return !!document.querySelector( 'pre code' ); }, callback: function() { hljs.initHighlightingOnLoad(); } },
        { src: 'plugin/zoom-js/zoom.js', async: true },
        { src: 'plugin/notes/notes.js', async: true }
        ]
      });

      var context = document.getElementById("semantics_pyramid").getContext("2d");
      var width = 400;  // Triangle Width
      var height = 400; // Triangle Height
      var padding = 20;

      // Draw a path
      context.beginPath();
      context.moveTo(padding + width/2, padding);        // Top Corner
      context.lineTo(padding + width, height + padding); // Bottom Right
      context.lineTo(padding, height + padding);         // Bottom Left
      context.closePath();

      // Fill the path
      context.fillStyle = "#B2E6FF";
      context.fill();
      // Add a horizon reflection with a gradient to transparent
      gradient = context.createLinearGradient(0,padding,0,padding+height);
      gradient.addColorStop(0.5, "transparent");
      gradient.addColorStop(0.5, "#B2E6FF");
      gradient.addColorStop(1, "#80CC99");

      // Fill the path
      context.fillStyle = gradient;
      context.fill();
      context.font = "30px Arial";
      context.fillStyle = "black";
      context.fillText("Application Semantics",width/1.9,height/6);
      context.fillText("Protocol Semantics",width/1.5,height);

      Reveal.addEventListener( 'fragmentshown', function( event ) {
        if(event.fragment.id == "fill_the_gap"){
          context.fillText("Hypermedia!",width/1.5,height/1.7);
        }
      });
    </script>

  </body>
</html>
